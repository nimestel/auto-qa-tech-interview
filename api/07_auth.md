## Способы авторизации

###1. HTTP Basic аутентификация 
   
Используется специальный HTTP заголовок `Authorization`, значение которого равно комбинации 
логина пользователя и пароля, закодированной в base64 формате. 
   
`Authorization: Basic base64(login: password)`

````
GET /spec.html HTTP/1.1
Host: www.example.org
Authorization: Basic QWxhZGRpbjpvcGVuIHNlc2FtZQ==
````

Плюс - простота и очевидность работы

Минусы:
- логин и пароль не зашифрованы 
- нужно отправлять пароль пользователя в каждом запросе 
- метод не защищен от подделки заголовка или тела запроса, уязвим к атаке повторного воспроизведения

###2. OAuth 2.0 (Token-Based Authentication, Bearer Authentication)
Открытый протокол, позволяющий предоставить доступ третьей стороне к защищенным ресурсам 
пользователя без передачи пароля третьей стороне

````
GET /resource/1 HTTP/1.1
Host: example.com
Authorization: Bearer mF_9.B5f-4.1JqM
````
Плюсы:
- Безопасность основана на SSL
- Предоставляет удобные сценарии доступа не только для веб, а также для
   десктоп и мобильных приложений
- Токен имеет более короткий срок жизни, если получен доступ злоумышленниками, то ненадолго
- Не надо хранить пароли в базе данных на сервере
- В некоторых случаях можно вообще избавиться от базы данных на сервере и получать всю 
  необходимую информацию из Google или других систем.
- Токен автоматически не уйдет на сторонний сайт, как Cookie.
  

- Минусы:
- Уязвимость к атакам "перехват-в-середине"
- Должен использоваться только через HTTPS

### JWT Token Authentication

JWT (JSON Web Token) - это токен, который кодирует объекты json в Base64, зашифрованные, 
компактные и автономные, и использует для передачи информации между двумя узлами в сети.
Эту информацию можно проверить и доверять ей, поскольку она имеет цифровую подпись. 

JWT могут быть подписаны с использованием секрета (с помощью алгоритма HMAC) или пары открытого/закрытого ключа с использованием RSA или ECDSA .

- Как только пользователь войдет в систему, каждый последующий запрос будет включать JWT, 
позволяя пользователю получать доступ к маршрутам, службам и ресурсам, разрешенным с помощью этого токена. 
- SSO (Single Sign On) широко использует JWT из-за небольших накладных расходов и легкого 
  использования в разных доменах.

JWT состоит из трех частей:
1. Заголовок, который определяет тип алгоритма шифрования (например: HS256) и тип определения (JWT).
   
   `{
   "alg": "HS256",
   "typ": "JWT"
   }`
2. Полезная нагрузка - основная информация, переносимая токеном (кодируется в base64)
   
   `{
   "sub": "1234567890",
   "name": "John Doe",
   "admin": true
   }`
3. Подпись токена - чтобы создать часть подписи, вы должны взять закодированный заголовок, 
   закодированную полезную нагрузку, секрет, алгоритм, указанный в заголовке, и подписать это:
```
HMACSHA256(
base64UrlEncode(header) + "." +
base64UrlEncode(payload),
secret)
```

Все вместе

JWT обычно выглядит следующим образом `xxxxx.yyyyy.zzzzz`

Вывод представляет собой три строки Base64-URL, разделенные точками, которые можно легко передавать в средах HTML и HTTP, при этом они более компактны по сравнению со стандартами на основе XML.

`const token = encodeBase64Url(header) + '.' + encodeBase64Url(payload) + '.' + encodeBase64Url(signature)`

Ниже показан JWT с закодированным предыдущим заголовком и полезной нагрузкой, подписанный секретом.

```
eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9
.eyJ1c2VySWQiOiJiMDhmODZhZi0zNWRhLTQ4ZjItOGZhYi1jZWYzOTA0NjYwYmQifQ
.-xN_h82PHVTCMA9vdoHrcZxH-x5mb11y1537t3rGzcM
```

###API key

API Key — это строка символов, которую передает клиент в запросах к серверу. Для успешной аутентификации строка должна совпадать у клиента и у сервера. 
Данная схема обеспечивает защиту от несанкционированного использования API и позволяет осуществлять, например, проверку лимитов использования API.

Передать ключ API можно либо с помощью заголовка аутентификации HTTP Basic, либо отправив 
api_key параметр через строку запроса или тело запроса.

```
curl -X GET 'https://username.carto.com/endpoint/?api_key=1234567890123456789012345678901234567890'
```

````
curl -X POST \
'https://username.carto.com/endpoint/' \
-H 'content-type: application/json' \
-d '{
"api_key": "1234567890123456789012345678901234567890"
}'
````


